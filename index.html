<!DOCTYPE html>
<html>
	<head>
		<title>Canvas Sprite Tests</title>
		<script type="text/javascript" src="js/fznPlatform.js"></script>
		<script type="text/javascript" src="js/fznLevels.js"></script>
		<script type="text/javascript" src="js/fznSprites.js"></script>
		<script type="text/javascript" src="js/fznBackgrounds.js"></script>
		<script type="text/javascript" src="js/fznWalls.js"></script>
		<script type="text/javascript" src="js/fznNPC.js"></script>
		<script>
			var game,luigi;
			function loadGame(){
				game = new fzn.Game("board");
				game.define("wall",[
					{
						name:"wall"
					}]
				)
				game.define("overlay",[
					{
						name:"gameOver",
						animation:"bounce",
						fixed:true,
						size: [76,16],
						source:"img/gameover.png"
					}
				]);
				game.define("background",[
					{
						name:"ground",
						size: [16,16],
						repeat: "repeat-x",
						source:"img/ground.jpg"
					},{
						name:"hills",
						size: [1887,201],
						repeat: false,
						source:"img/hills.png"
					},{
						name:"sky",
						size: [2,223],
						repeat: "repeat-x",
						source:"img/sky.png"
					},{
						name:"clouds",
						size: [267,113],
						opacity:0.6,
						repeat: false,
						fixed: 0.5,
						source:"img/clouds.png"
					}
				]);
				game.define("sprite",[
					{
						name: "luigi",
						source: "img/luigi-sprites.png",
						type: "user",
						shoot:"fireball",
						gravity: 0.8,
						collide: ["block","deadly"],
						onCollide: function(self,pos,col){
							var item;
							for(item in col.all){
								if(col.all[item].type == "deadly" && !col.all[item].dying){
									self.level.add("overlay","gameOver","gameOver",{pos:"center"});
									self.please("die");
								}
							}
						},
						size:[16,22],
						sprite: {
							R:{
								stand:{ delay:0, steps:[[234,0]]},
								walk:{  delay:5, steps:[[234,0],[263,0]]},
								run:{   delay:3, steps:[[321,0],[348,0]]},
								jump:{  delay:0, steps:[[294,30]]},
								fall:{  delay:0, steps:[[264,30]]},
								shoot:{ delay:0, steps:[[405,60]]}
							},
							L:{
								stand:{ delay:0, steps:[[198,0]]},
								walk:{  delay:5, steps:[[198,0],[169,0]]},
								run:{   delay:3, steps:[[111,0],[84,0]]},
								jump:{  delay:0, steps:[[139,30]]},
								fall:{  delay:0, steps:[[168,30]]},
								shoot:{ delay:0, steps:[[27,60]]}
							},
							dead:{  delay:3, steps:[[0,57],[432,57]]}
						}
					},{
						name: "qBlock",
						source: "img/blocks.png",
						type: "block",
						size:[16,16],
						sprite: {
							stand:{ delay:3, steps:[[0,0],[0,0],[0,0],[0,0],[0,0],[51,0],[34,0],[17,0]]}
						}
					},{
						name: "eBlock",
						source: "img/blocks.png",
						type: "block",
						size:[16,16],
						sprite: {
							stand:{ delay:0, steps:[[0,17]]}
						}
					},{
						name: "block",
						source: "img/blocks.png",
						type: "block",
						size:[16,16],
						sprite: {
							stand:{ delay:0, steps:[[17,17]]}
						}
					},{
						name: "spike",
						source: "img/enemies.png",
						type: "deadly",
						collide: ["block","deadly"],
						gravity: 0.6,
						jumpForce:5,
						size:[18,18],
						sprite: {
							L:{
								stand:{ delay:5, steps:[[0,77],[19,77]]},
								dead: { delay:0, steps:[[94,77]]}
							},
							R:{
								stand:{ delay:5, steps:[[459,320],[478,320]]},
								dead: { delay:0, steps:[[365,320]]}
							}
						}
					},{
						name: "fireball",
						source: "img/enemies.png",
						type: "userPower",
						collide: ["block","deadly"],
						onCollide: function(self,pos,col){
							var item;
							for(item in col.all){
								if(col.all[item].type == "deadly" && !col.all[item].dying){
									col.all[item].please("die");
									self.alive=false;
								}
							}
						},
						lifetime:30,
						gravity: 0.6,
						size:[9,9],
						NPC:"bounce",
						jumpForce:5,
						sprite: {
							stand: { delay:3, steps:[[435,8],[445,7],[455,7],[465,7]]}
						}
					}
				]);
				game.define("level",{
					name: "level01",
					floor: 285,
					color: "#5088A0",
					size: [600,300],
					sprites:[
						{copyOf: "luigi",  id: "luigi"},
						{copyOf: "spike",  params: {pos:[100,220],NPC:"jump"}},
						{copyOf: "spike",  params: {pos:[100,220],NPC:"walk"}},
						{copyOf: "spike",  params: {pos:[120,220]}},
						{copyOf: "spike",  params: {pos:[140,220]}},
						{copyOf: "spike",  params: {pos:[160,220]}},
						{copyOf: "spike",  params: {pos:[180,220]}},
						{copyOf: "spike",  params: {pos:[200,220]}},
						{copyOf: "spike",  params: {pos:[220,220]}},
						{copyOf: "spike",  params: {pos:[240,220]}},
						{copyOf: "spike",  params: {pos:[260,220]}},
						{copyOf: "spike",  params: {pos:[280,220]}},
						{copyOf: "spike",  params: {pos:[300,220]}},
						{copyOf: "spike",  params: {pos:[320,220]}},
						{copyOf: "spike",  params: {pos:[340,220]}},
						{copyOf: "spike",  params: {pos:[360,220]}},
						{copyOf: "spike",  params: {pos:[380,220]}},
						{copyOf: "spike",  params: {pos:[400,220]}},
						{copyOf: "spike",  params: {pos:[420,220]}},
						{copyOf: "spike",  params: {pos:[440,220]}},
						{copyOf: "spike",  params: {pos:[460,220]}},
						{copyOf: "spike",  params: {pos:[480,220]}},
						{copyOf: "spike",  params: {pos:[500,220]}},
						{copyOf: "spike",  params: {pos:[520,220]}},
						{copyOf: "spike",  params: {pos:[540,220]}},
						{copyOf: "spike",  params: {pos:[560,220]}},
						{copyOf: "qBlock", params: {pos:[100,200]}},
						{copyOf: "eBlock", params: {pos:[116,200]}},
						{copyOf: "block",  params: {pos:[132,200]}},
						{copyOf: "block",  params: {pos:[148,200]}},
						{copyOf: "block",  params: {pos:[68,232]}},
						{copyOf: "block",  params: {pos:[200,200]}},
						{copyOf: "block",  params: {pos:[300,200]}},
						{copyOf: "block",  params: {pos:[400,200]}},
						{copyOf: "block",  params: {pos:[500,200]}}
					],
					backgrounds:[
						{copyOf: "sky", id: "mainSky", params: {pos:[0,100]}},
						{copyOf: "clouds", id: "mainClouds", params: {pos:[50,170]}},
						{copyOf: "hills", id: "mainHills", params: {pos:[0,83]}},
						{copyOf: "ground", id: "mainGround", params: {pos:[0,284]}}
					],
					walls:[
						{copyOf: "wall", params: {pos:[50,250],size:[20,50],color:"white"}}
					]
				});
				game.loadLevel("level01");
			}
		</script>
	</head>
	<body onload="loadGame();">
		<canvas id="board" width="300" height="300"></canvas>
	</body>
</html>
